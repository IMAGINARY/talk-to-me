const assert = require('assert');
const tf = require('@tensorflow/tfjs-node');

function createTensor() {
    const sparseIndices = [[0, 1], [1, 1], [2, 2], [3, 2], [4, 3], [5, 3], [5, 4], [6, 4], [7, 5], [8, 5], [9, 6], [10, 6], [10, 7], [11, 7], [12, 8], [13, 8], [14, 9], [15, 9], [16, 10], [17, 10], [17, 11], [18, 11], [19, 12], [20, 12], [21, 13], [22, 13], [22, 14], [23, 14], [24, 15], [25, 15], [26, 16], [27, 16], [28, 17], [29, 17], [29, 18], [30, 18], [31, 19], [32, 19], [33, 20], [34, 20], [34, 21], [35, 21], [36, 22], [37, 22], [38, 23], [39, 23], [40, 24], [41, 24], [41, 25], [42, 25], [43, 26], [44, 26], [44, 27], [45, 27], [46, 28], [47, 28], [47, 29], [48, 29], [49, 30], [50, 30], [50, 31], [51, 31], [52, 32], [53, 32], [53, 33], [54, 33], [54, 34], [55, 34], [55, 35], [56, 35], [56, 36], [57, 36], [58, 37], [59, 37], [59, 38], [60, 38], [60, 39], [61, 39], [61, 40], [62, 40], [62, 41], [63, 41], [63, 42], [64, 42], [64, 43], [65, 43], [65, 44], [66, 44], [66, 45], [67, 45], [67, 46], [67, 47], [68, 46], [68, 47], [68, 48], [69, 48], [69, 49], [70, 49], [70, 50], [71, 50], [71, 51], [72, 51], [72, 52], [72, 53], [73, 52], [73, 53], [73, 54], [74, 54], [74, 55], [75, 55], [75, 56], [75, 57], [76, 56], [76, 57], [76, 58], [77, 58], [77, 59], [78, 59], [78, 60], [78, 61], [79, 60], [79, 61], [79, 62], [80, 62], [80, 63], [80, 64], [81, 63], [81, 64], [81, 65], [82, 65], [82, 66], [82, 67], [83, 66], [83, 67], [83, 68], [83, 69], [84, 68], [84, 69], [84, 70], [85, 70], [85, 71], [85, 72], [86, 71], [86, 72], [86, 73], [86, 74], [87, 73], [87, 74], [87, 75], [87, 76], [88, 75], [88, 76], [88, 77], [88, 78], [89, 77], [89, 78], [89, 79], [90, 79], [90, 80], [90, 81], [91, 80], [91, 81], [91, 82], [91, 83], [92, 82], [92, 83], [92, 84], [92, 85], [93, 84], [93, 85], [93, 86], [93, 87], [93, 88], [94, 86], [94, 87], [94, 88], [94, 89], [94, 90], [95, 89], [95, 90], [95, 91], [95, 92], [96, 91], [96, 92], [96, 93], [96, 94], [97, 93], [97, 94], [97, 95], [97, 96], [97, 97], [98, 95], [98, 96], [98, 97], [98, 98], [98, 99], [99, 98], [99, 99], [99, 100], [99, 101], [100, 100], [100, 101], [100, 102], [100, 103], [100, 104], [101, 102], [101, 103], [101, 104], [101, 105], [101, 106], [102, 105], [102, 106], [102, 107], [102, 108], [102, 109], [103, 107], [103, 108], [103, 109], [103, 110], [103, 111], [103, 112], [104, 110], [104, 111], [104, 112], [104, 113], [104, 114], [105, 113], [105, 114], [105, 115], [105, 116], [105, 117], [106, 115], [106, 116], [106, 117], [106, 118], [106, 119], [106, 120], [107, 118], [107, 119], [107, 120], [107, 121], [107, 122], [107, 123], [108, 121], [108, 122], [108, 123], [108, 124], [108, 125], [108, 126], [109, 124], [109, 125], [109, 126], [109, 127], [109, 128], [109, 129], [110, 127], [110, 128], [110, 129], [110, 130], [110, 131], [110, 132], [111, 130], [111, 131], [111, 132], [111, 133], [111, 134], [111, 135], [112, 133], [112, 134], [112, 135], [112, 136], [112, 137], [112, 138], [112, 139], [113, 136], [113, 137], [113, 138], [113, 139], [113, 140], [113, 141], [113, 142], [114, 140], [114, 141], [114, 142], [114, 143], [114, 144], [114, 145], [114, 146], [115, 143], [115, 144], [115, 145], [115, 146], [115, 147], [115, 148], [115, 149], [116, 147], [116, 148], [116, 149], [116, 150], [116, 151], [116, 152], [116, 153], [117, 150], [117, 151], [117, 152], [117, 153], [117, 154], [117, 155], [117, 156], [117, 157], [118, 154], [118, 155], [118, 156], [118, 157], [118, 158], [118, 159], [118, 160], [119, 158], [119, 159], [119, 160], [119, 161], [119, 162], [119, 163], [119, 164], [120, 161], [120, 162], [120, 163], [120, 164], [120, 165], [120, 166], [120, 167], [120, 168], [121, 165], [121, 166], [121, 167], [121, 168], [121, 169], [121, 170], [121, 171], [121, 172], [121, 173], [122, 169], [122, 170], [122, 171], [122, 172], [122, 173], [122, 174], [122, 175], [122, 176], [122, 177], [123, 174], [123, 175], [123, 176], [123, 177], [123, 178], [123, 179], [123, 180], [123, 181], [124, 178], [124, 179], [124, 180], [124, 181], [124, 182], [124, 183], [124, 184], [124, 185], [124, 186], [125, 182], [125, 183], [125, 184], [125, 185], [125, 186], [125, 187], [125, 188], [125, 189], [125, 190], [126, 187], [126, 188], [126, 189], [126, 190], [126, 191], [126, 192], [126, 193], [126, 194], [126, 195], [127, 191], [127, 192], [127, 193], [127, 194], [127, 195], [127, 196], [127, 197], [127, 198], [127, 199]];
    const sparseValues = [0.012373986653983593, 0.030392564833164215, 0.024747973307967186, 0.018018579110503197, 0.037121959030628204, 0.005644591990858316, 0.006729394197463989, 0.03603715822100639, 0.019103379920125008, 0.023663168773055077, 0.031477365642786026, 0.011289183981716633, 0.0010848019737750292, 0.04168175160884857, 0.013458788394927979, 0.029307762160897255, 0.025832774117588997, 0.016933776438236237, 0.038206759840250015, 0.004559790249913931, 0.007814195938408375, 0.03495235741138458, 0.020188182592391968, 0.022578367963433266, 0.032562170177698135, 0.010204383172094822, 0.0021696039475500584, 0.04059694707393646, 0.01454358920454979, 0.028222959488630295, 0.026917576789855957, 0.015848975628614426, 0.039291560649871826, 0.0034749882761389017, 0.008898998610675335, 0.03386755287647247, 0.021272985264658928, 0.021493567153811455, 0.033646970987319946, 0.009119580499827862, 0.003254405688494444, 0.03951214626431465, 0.01562839187681675, 0.027138158679008484, 0.028002377599477768, 0.014764172956347466, 0.040376365184783936, 0.0023806870449334383, 0.010202637873589993, 0.03161146119236946, 0.024547001346945763, 0.015329193323850632, 0.001665837480686605, 0.036729052662849426, 0.020097099244594574, 0.016931025311350822, 0.0029026553966104984, 0.032844990491867065, 0.023520048707723618, 0.011038944125175476, 0.010725829750299454, 0.022718291729688644, 0.03227872774004936, 0.00011626833293121308, 0.022853482514619827, 0.008563440293073654, 0.014979788102209568, 0.015513983555138111, 0.008514906279742718, 0.02110680378973484, 0.003326520323753357, 0.02547064796090126, 0.02735907956957817, 0.0006585361552424729, 0.02383812516927719, 0.0034435924608260393, 0.021224552765488625, 0.0053584217093884945, 0.019425557926297188, 0.006493247114121914, 0.018355421721935272, 0.006931380834430456, 0.017935046926140785, 0.0067496825940907, 0.018091518431901932, 0.006018991116434336, 0.018757672980427742, 0.004804528318345547, 0.019871728494763374, 0.0031662785913795233, 0.02137690968811512, 0.001253173453733325, 0.0011593446834012866, 0.02080361731350422, 0.004044868052005768, 0.017553631216287613, 0.007083200383931398, 0.014075386337935925, 0.010326550342142582, 0.010409214533865452, 0.013736963272094727, 0.006591876968741417, 0.017279881983995438, 0.0014680421445518732, 0.0026568188332021236, 0.01809193193912506, 0.005856557283550501, 0.013342779129743576, 0.010282675735652447, 0.00856800377368927, 0.01472230814397335, 0.001040398608893156, 0.003790855873376131, 0.01714678481221199, 0.006116092670708895, 0.011759290471673012, 0.011133937165141106, 0.006438578478991985, 0.01607806235551834, 0.004239172209054232, 0.0011998937698081136, 0.012756715528666973, 0.00965298991650343, 0.007069352548569441, 0.014940546825528145, 0.004190248437225819, 0.0015148338861763477, 0.012008999474346638, 0.009848233312368393, 0.006102240178734064, 0.01533857174217701, 0.005576768424361944, 0.00036827256553806365, 0.00989749375730753, 0.011353404261171818, 0.0020512230694293976, 0.003892971435561776, 0.012973522767424583, 0.00806631613522768, 0.006744932383298874, 0.013858746737241745, 0.005411905236542225, 0.0007422015769407153, 0.008987790904939175, 0.011378713883459568, 0.003329580882564187, 0.0028231353498995304, 0.010680492967367172, 0.00943340640515089, 0.0017632555682212114, 0.0043901861645281315, 0.011877589859068394, 0.007970058359205723, 0.0006610470009036362, 0.005494666751474142, 0.012629535980522633, 0.00693987961858511, 0.006184019148349762, 0.0129347313195467, 0.00629778765141964, 0.000023252101527759805, 0.006502066273242235, 0.0123266177251935, 0.006002165377140045, 0.00031548753031529486, 0.006489255465567112, 0.012041302397847176, 0.006014628801494837, 0.00029979555984027684, 0.006182880140841007, 0.012042728252708912, 0.006299811881035566, 0.0005568959750235081, 0.000011204706424905453, 0.005617291666567326, 0.011223378591239452, 0.0068251630291342735, 0.0013526449911296368, 0.004824100062251091, 0.010166232474148273, 0.007560755126178265, 0.002345903078094125, 0.003832357469946146, 0.008922962471842766, 0.00847910437732935, 0.003509786445647478, 0.0026687318459153175, 0.007519651670008898, 0.009555005468428135, 0.004819661378860474, 0.00008431751484749839, 0.001357673667371273, 0.005980195011943579, 0.01060271542519331, 0.0062529849819839, 0.0017405991675332189, 0.004326442256569862, 0.008731318637728691, 0.007789165247231722, 0.003489238675683737, 0.0025783509481698275, 0.006775828544050455, 0.00940941646695137, 0.005311945918947458, 0.0012144759530201554, 0.0007541119121015072, 0.004753957036882639, 0.008753802627325058, 0.007192090153694153, 0.003287544008344412, 0.0026817969046533108, 0.0064933146350085735, 0.009114579297602177, 0.005393873900175095, 0.0016731682699173689, 0.0005739429616369307, 0.0042060003615915775, 0.007838058285415173, 0.007520230021327734, 0.003974708262830973, 0.00042918731924146414, 0.0019046447705477476, 0.005365691613405943, 0.008826738223433495, 0.0062760948203504086, 0.0028975096065551043, 0.0028988525737076998, 0.006196940783411264, 0.008566990494728088, 0.005347481928765774, 0.002127972897142172, 0.0004475022724363953, 0.0035903039388358593, 0.006733105983585119, 0.007770236115902662, 0.004702313803136349, 0.0016343912575393915, 0.0010153602343052626, 0.004010187461972237, 0.007005014456808567, 0.007234429940581322, 0.0043109566904604435, 0.0013874832075089216, 0.0013334885006770492, 0.004187308251857758, 0.007041127886623144, 0.0069318837486207485, 0.004146058112382889, 0.0013602323597297072, 0.0014287971425801516, 0.004148248583078384, 0.006867699790745974, 0.006837052758783102, 0.004182394593954086, 0.0015277357306331396, 0.0013261043932288885, 0.003917513880878687, 0.006508923601359129, 0.006926396861672401, 0.0043967291712760925, 0.0018670617137104273, 0.0010482777142897248, 0.0035176740493625402, 0.0059870705008506775, 0.007178240455687046, 0.004767679143697023, 0.002357117598876357, 0.0006163640646263957, 0.0029694922268390656, 0.005322620272636414, 0.007572650909423828, 0.005275587551295757, 0.0029785241931676865, 0.0006814609514549375, 0.000049713995394995436, 0.0022920481860637665, 0.004534382373094559, 0.006776716560125351, 0.0059024072252213955, 0.00371349835768342, 0.0015245892573148012, 0.0015028533525764942, 0.0036396104842424393, 0.005776367150247097, 0.0066315908916294575, 0.004545743577182293, 0.002459896495565772, 0.00037404923932626843, 0.0006179586052894592, 0.00265410915017128, 0.004690259229391813, 0.006726410239934921, 0.005460347048938274, 0.0034727093297988176, 0.0014850713778287172, 0.001592335756868124, 0.0035326166544109583, 0.005472897551953793, 0.0064436825923621655, 0.004549629986286163, 0.002655577613040805, 0.0007615251233801246, 0.00046749351895414293, 0.0023164190351963043, 0.004165344405919313, 0.0060142697766423225, 0.005678446963429451, 0.0038735736161470413, 0.002068700036033988, 0.0002638266596477479, 0.0010534910252317786, 0.002815362298861146, 0.0045772334560751915, 0.006339104846119881, 0.0051281568594276905, 0.0034082632046192884, 0.0016883700154721737, 0.0014335009036585689, 0.0031124167144298553, 0.00479133240878582, 0.00640943692997098, 0.004770522005856037, 0.0031316077802330256, 0.0014926930889487267, 0.000029323589842533693, 0.001629189937375486, 0.003229056019335985, 0.00482892245054245, 0.006146714556962252, 0.004584966227412224, 0.0030232176650315523, 0.0014614691026508808, 0.00013601698447018862, 0.001660555717535317, 0.003185094567015767, 0.004709633067250252, 0.006040723994374275, 0.0045525087043643, 0.003064292948693037, 0.001576077425852418, 0.00008786193211562932, 0.00009328097075922415, 0.001546038780361414, 0.002998796757310629, 0.004451554734259844, 0.0059043122455477715, 0.0046556610614061356, 0.003237516153603792, 0.0018193712458014488, 0.00040122633799910545, 0.0013026263331994414, 0.002686982974410057, 0.004071339499205351, 0.005455696024000645, 0.004878324922174215, 0.0035269514191895723, 0.0021755779162049294, 0.0008242045878432691, 0.0009459502762183547, 0.002265126211568713, 0.0035843022633343935, 0.0049034785479307175, 0.005205697845667601, 0.0039179520681500435, 0.00263020652346313, 0.001342460629530251, 0.00005471494296216406, 0.0004903789376839995, 0.0017474433407187462, 0.003004507627338171, 0.004261571913957596, 0.005518636200577021, 0.004397072363644838, 0.0031699584797024727, 0.001942844595760107, 0.0007157306536100805, 0.0011469805613160133, 0.002344857668504119, 0.0035427347756922245, 0.004740611650049686, 0.0049519846215844154, 0.003782647429034114, 0.002613310469314456, 0.0014439737424254417, 0.0002746368118096143, 0.0004756950947921723, 0.0016171716852113605, 0.002758648479357362, 0.0039001251570880413, 0.005041601601988077, 0.004457120783627033, 0.003342840587720275, 0.0022285603918135166, 0.0011142801959067583];
    const shape = [128, 201];
    return tf.sparseToDense(sparseIndices, sparseValues, shape, 0.0);
}

const mel_16000_400_128 = createTensor();

function mel(sr, n_fft, n_mels) {
    assert(sr === 16000 && n_fft === 400 && n_mels === 128, "mel filter only implemented for sr === 16000 && n_fft === 400 && n_mels === 128");
    return mel_16000_400_128;
}

module.exports = mel;
